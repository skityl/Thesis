% Chapter 1

\chapter{The Chain Rule in Quantised Calculus} % Main chapter title

\label{TheChainRule} % For referencing the chapter elsewhere, use \ref{Chapter1} 

\lhead{Chapter \ref{TheChainRule}. \emph{The Chain Rule in Quantised Calculus}} % This is for the header on each page - perhaps a shortened title

%----------------------------------------------------------------------------------------

\section{Introduction}

 It is desirable
to find a noncommutative generalisation of the chain rule. In classical analysis,
as practiced by Newton and Leibniz, the chain rule could be stated as:
\begin{equation}
\label{classicalChainRule}
    df(x) = f'(x)dx+o(dx)
\end{equation}
where $f:\Rl\to\Rl$, and $dx$ denotes some infinitesimal increment.
The term $o(dx)$ denotes an infinitesimal quantity much smaller than $dx$. 
One could then ``ignore sufficiently small infinitesimals" to get,
\begin{equation}
    df(x) = f'(x)dx.
\end{equation}  

In the setting of quantised calculus, ``ignoring sufficiently small infinitesimals"
means working modulo some ideal of compact operators whose singular values
decay sufficiently rapidly.


\section{The setting}
Let $\Hilb$ be, as usual, a complex separable Hilbert space. We
define symmetrically normed ideals of $\mathcal{B}(\Hilb)$.
\begin{definition}
    Let $\mathcal{E}$ be a two-sided ideal of $\mathcal{B}(\Hilb)$
    equipped with a norm $\|\cdot\|_{\mathcal{E}}$ which satisfies the inequality
    \begin{equation}
        \|ACB\|_{\mathcal{E}} \leq \|A\|\|C\|_\mathcal{E}\|\|B\|
    \end{equation}
    for $A,B \in \mathcal{B}(\Hilb)$ and $C \in \mathcal{E}$.
\end{definition}

\begin{definition}
    If $\mathcal{E}$ is an ideal of operators containing the ideal of finite rank
    operators, we denote the closure of the finite rank operators in the $\|\cdot\|_\mathcal{E}$
    norm as $\mathcal{E}_0$.
\end{definition}

\begin{definition}[Almost circular spectral triples]
    Let $(\A,\Hilb,\D)$ be a spectral triple. We say that $(\A,\Hilb,\D)$
    is \emph{almost circular} with respect
    to the symmetrically normed ideal $\mathcal{E}$
     if the following properties are satisfied:
    \begin{enumerate}
        \item{} For all $a \in \A$, $\qd a \in \mathcal{E}$.
        \item{} $\A$ is closed under the holomorphic functional calculus.
        \item{} Let $\A_0 \subseteq \mathcal{B}(\Hilb)$ be the collection of all
        $T$ such that $[\sgn(\D),T]$ is finite rank. Then $\A$ is contained
        within the norm-closure of $\A_0$.
        \item{} $\A$ is commutative.
        \item{} $\mathcal{E}$ contains the finite rank operators.
    \end{enumerate}
\end{definition}


\section{The Commutator Lemma}
\begin{lemma}
\label{commutator}
    Let $(\A,\Hilb,\D)$ be almost circular with respect to the ideal $\mathcal{E}$, and $a,b \in \A$. Then
    \begin{equation*}
        [\qd a,b] \in \mathcal{E}_0.
    \end{equation*}
\end{lemma}
\begin{proof}
    Consider the map $T:\A\to\mathcal{E}$,
    \begin{equation*}
        T(x) = [\qd a,x].
    \end{equation*}
    Since $T(x)$
    is a polynomial in $x$, $T$ is continuous from $\A$ to $\mathcal{E}$
    since $\mathcal{L}^{p,\infty}$ is a symmetrically normed ideal. Now since
    $\A$ is commutative,
    \begin{equation*}
        [\qd a,x] = [a,\qd x].
    \end{equation*}
    
    Hence, for $x \in \A_0$, we have $T(x)$ is finite rank. Since $\A_0$
    is dense in $\A$, we conclude that $T(x) \in \mathcal{E}_0$
    for $x \in \A$. Now set $x = b$ and the claim is proved.
\end{proof}

\section{The Chain rule}

\begin{lemma}
\label{polychain}
    Let $(\A,\Hilb,\D)$ be almost circular with respect
    to the ideal $\mathcal{E}$. Let $p \in \Cplx[x_1,\ldots,x_n]$ be a polynomial,
    and $a_1,\ldots,a_n \in \A$. 
    Then,
    \begin{equation}
        \qd p(a_1,\ldots,a_n) \equiv \sum_{k=1}^n \frac{\partial p}{\partial x_k}(a_1,\ldots,a_n)\;\qd a_k\; \mod{\mathcal{E}_0}
    \end{equation}
\end{lemma}
\begin{proof}
    First we consider the case where $p$ is a monomial of a single variable,
    that is $p(x_1,\ldots,x_n) = x_j^k$ for some $j,k$. We can compute,
    \begin{align}
        \qd p(a_1,\ldots,a_n) &= [F,a_j^k] \\
        &= \sum_{m=1}^{k} a_j^{m-1} [F,a_j] a_j^{k-m}
    \end{align}
    By lemma \ref{commutator}, this implies
    \begin{align}
        \qd p(a_1,\ldots,a_n) \equiv ka_j^{k-1}\; \qd a_j\; \mod{\mathcal{E}_0}.
    \end{align}
    
    Hence the claim is proved for $p(x_1,\ldots,x_n) = x_j^k$. The general claim
    follows from the following Leibniz rule:
    \begin{align}
        \qd (ab) &= (\qd a)b + b(\qd a)\\
                 &\equiv b(\qd a) + a(\qd b) \;\mod{\mathcal{E}_0}
    \end{align}
    and linearity.
\end{proof}

\begin{proposition}
\label{holoChainRule}
    Let $(\A,\Hilb,\D)$ be an almost circular spectral triple with respect
    to the ideal $\mathcal{E}$. Let $a \in \A$,
    and let $\varphi$ be holomorphic on a simply connected neighbourhood of $\sigma(a)$.
    Then define $\varphi(a)$ by the holomorphic functional calculus. Then,
    \begin{equation}
        \qd \varphi(a) \equiv \varphi'(a)\qd a\;\mod{\mathcal{E}_0}
    \end{equation}
\end{proposition}
\begin{proof}
    By lemma \ref{polychain}, the result is true when $\varphi$
    is a polynomial. Since $\varphi$ is holomorphic on a simply connected set,
    there is a sequence $\{p_n\}_{n=1}^\infty$ that converges to $\varphi$
    uniformly on $\sigma(a)$, and $\{p_n'\}_{n=1}^\infty$ converges
    uniformly to $\varphi$. Thus the result follows.
\end{proof}
Our proposition \ref{holoChainRule} is inspired by Theorem 8b of Connes' 
book \cite{Connes94}. Connes' proves this result for $(\A,\Hilb,\D) = (C^\infty(\Circ),L^2(\Circ),\D_\Circ)$.
In that book, the equivalent of \ref{holoChainRule} is proved for $\varphi \in C^\infty(\sigma(a))$,
and $a = a^*$. So our result is neither more or less general than Connes', but it
applies in a more abstract situation of an almost circular spectral triple.


%\begin{proposition}
%    Let $(\A,\Hilb,\D)$ be a spectral triple as above. Let $a := (a_1,\ldots,a_n) \in \A^n$,
%    and let $\varphi$ be a complex valued function holomorphic
%    on a neighbourhood of
%    the joint spectrum, $\sigma(a) := \sigma(a_1)\times \cdots \sigma(a_n) \subset \Cplx^n$.
%    
%    Since $a_1,\ldots,a_n$ pairwise commute, we can define $\varphi(a)$
%    by the holomorphic functional calculus.    
%    
%    Then,
%    \begin{equation}
%        \qd \varphi(a) \equiv d\varphi \qd a \;\mod{\mathcal{E}_0},
%    \end{equation}
%    where this is shorthand for,
%    \begin{equation}
%        \qd \varphi(a_1,\ldots,a_n) \equiv \sum_{j=1}^n \frac{\partial \varphi}{\partial z_j}(a)\qd a_j \;\mod{\mathcal{E}_0}.
%    \end{equation}
%\end{proposition}
%\begin{proof}
%    Consider the function $Q:C^1(\sigma(a))\to \mathcal{E}$
%    given by
%    \begin{equation}
%        Q(\varphi) = \qd \varphi(a) - d\varphi(a)\qd a.
%    \end{equation}
%    Note that this is indeed well defined: $\qd\varphi(a) \in \mathcal{E}$
%    since $\A$ is closed under the holomorphic functional calculus.
%    Now note that,
%    \begin{equation}
%        \|Q(\varphi)\|_{p,\infty} \leq 2\|\varphi(a)\| + 2\|d\varphi(a)\|\|a\|.
%    \end{equation}
%    where $\|a\| := \max_{j = 1,\ldots,n} \|a_j\|$
%    and $\|\varphi(a)\| := \max_{j=1,\ldots,n} \left\|\frac{\partial \varphi}{\partial z_j}(a)\right\|$.
    
%\end{proof}


\begin{example}
    An example of an almost circular spectral triple is $(C^\infty(\Circ),L^2(\Circ),\D_\Circ)$.
    The ideal $\mathcal{E}$ should be chosen to be $\mathcal{L}^{1,\infty}$. Then
    the class of elements $a \in C^\infty(\Circ)$ such that $\qd a$ is finite
    rank is exactly the rational functions. 
\end{example}

